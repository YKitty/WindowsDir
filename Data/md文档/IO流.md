# I/O流

---

C++的I/O对c的发展——类型安全和可扩展性

cout和cin并不是C++语言提供的语句，而是iostream类的对象。正如C++并没有提供赋值语句，只提供赋值表达式，在赋值表达式后面加上分号就成了C++的语句。

C++编译系统提供了用于输入和输出的iostream类库。

C++I/O库中的类称为流类，用流类定义的对象称为流对象：比如：cin，cout就是使用iostream流类创建的对象。这两个也就时流对象

插图：流类

![](C:\Users\0\Pictures\C++\流类.png)

插图：流类结构图

![](C:\Users\0\Pictures\C++\流类结构图.png)

在 iostream 头文件中定义的类有 ios，istream，ostream，iostream，istream _withassign， ostream_withassign，iostream_withassign 等。 

iostream.h包含了对输入输出流进行操作所需的基本信息。因此大多数C++程序都包括iostream.h。在iostream.h头文件中不仅定义了有关的类，还定义了4种流对象 

![](C:\Users\0\Pictures\C++\4中流对象.png)

在iostream头文件中定义以上4个流对象用以下的形式（以cout为例）：     ostream cout ( stdout); 在定义cout为ostream流类对象时，把标准输出设备stdout作为参数，这样它就与标准输出设备(显示器)联系起来，

如果有     cout <<3; 

就会在显示器的屏幕上输出3。 



在iostream头文件中重载运算符

“<<”和“>>”本来在C++中是被定义为左位移运算符和右位移运算符的，由于在iostream头文件中对它们进行了重载，使它们能用作标准类型数据的输入和输出运算符。所以，在用它们的程序中必须用#include命令把iostream包含到程序中。#include <iostream>

在istream和ostream类（这两个类都是在iostream中声明的）中分别有一组成员函数对位移运算符“<<”和“>>”进行重载，以便能用它输入或输出各种标准数据类型的数据。



四种流对象cin，cout，cerr，clog

cout和clog具有缓存区，cerr没有缓存区

cerr流对象是标准错误流，cerr流已被指定为显示器关联

cout流通常是传送到显示器输出，但也可以被重定向输出到磁盘文件，而cerr流中的信息只能在显示器输出 

clog流对象也是标准错误流，它是console log的缩写。它的作用和cerr相同，都是在终端显示器上显示出错信息。区别：cerr是不经过缓冲区，直接向显示器上输出有关信息，而clog中的信息存放在缓冲区中，缓冲区满后或遇endl时向显示器输出。 



cout和插入运算符“<<”实现输出，cout流在内存中有相应的缓冲区 

专用于输出单个字符的成员函数put。 

cout.put('a'); 调用该函数的结果是在屏幕上显示一个字符a。put函数的参数可以是字符或字符的ASCII代码(也可以是一个整型表达式)。 

可以在一个语句中连续调用put函数。如：     cout.put(71).put(79).put(79). put(68).put('\n'); 在屏幕上显示GOOD。 

成员函数put不仅可以用cout流对象来调用，而且也可以用ostream类的其他流对象调用。





cin是istream类的对象，它从标准输入设备(键盘)获取数据，程序中的变量通过流提取符“>>”从流中提取数据。流提取符“>>”从流中提取数据时通常跳过输入流中的空格、tab键、换行符等空白字符 

只有在输入完数据再按回车键后，该行数据才被送入键盘缓冲区，形成输入流，提取运算符“>>”才能从中提取数据。需要注意保证从流中读取数据能正常进行。 

例如：     int a,b;     

cin>>a>>b;

 若从键盘上输入     21  abc↙ 

变量a从输入流中提取整数21，提取操作成功，此时cin流处于正常状态。但在变量b准备提取一个整数时，遇到了字母a，显然提取操作失败了，此时，cin流被置为出错状态。只有在正常状态时，才能从输入流中提取数据。  当遇到无效字符或遇到文件结束符（不是换行符，是文件中的数据已读完）时，输入流cin就处于出错状态，即无法正常提取数据。此时对cin流的所有提取操作将终止。在 **IBM PC及其兼容机中，以Ctrl + Z表示文件结束符**。在**UNIX和Macintosh系统中，以 Ctrl + D表示文件结束符。**  



get()函数是输入流istream流对象的成员函数。有三种形式，无参，带一个参数，三个参数

cin.get()没有参数，其返回值就是键盘上输入的字符

如遇到输入流中的文件结束符函数返回文件描述标志EOF，一般-1代表EOF

cin.get(ch)一个参数从输入流提取一个字符赋给字符ch

成功返回true，失败返回false

cin.get(字符数组,字符个数, 终止字符)或cin.get(字符指针,字符个数, 终止字符)

其作用是从输入流中读取n-1个字符，赋给指定的字符数组(或字符指针指向的数组)，如果在读取n-1个字符之前遇到指定的终止字符，则提前结束读取。如果读取成功则函数返回true(真)，如失败(遇文件结束符) 则函数返回false(假) 



getline函数的作用是从输入流中读取一行字符,其用法与带3个参数的get函数类似。即     cin.getline(字符数组(或字符指针), 字符个数n, 终止标志字符)  

getline()函数也可以只有两个参数，最后的终止字符默认为'\n'

对于使用输入流对象的话，如果输入流中还有数据的话，就不会要求从键盘输入

如果在用cin.getline(ch, 20, '/')从输入流读取数据时，**遇到回车键("\n")，是否 结束读取？结论是此时"\n"不是结束标志"\n"被作为一个字符被读入。** 



cin<<和cin.getline函数的区别

cin函数读取数据的时候以空白字符（空格，tab，回车键）作为终结标志，cin.getline可以读入空白字符

使用cin<< 可以读入C++的内置类型的数据，而使用gcin.getline只能读取字符数据



get函数和getline函数的区别

 用getline函数从输入流读字符时，遇到终止标志字符时结束，**指针移到该终止标志字符之后**，下一个getline函数将从该终止标志的下一个字符开始接着读入，如本程序运行结果所示那样。如果用cin.get函数从输入流读字符时，**遇终止标志字符时停止读取，指针不向后移动，仍然停留在原位置**。下一次读取时仍从该终止标志字符开始。这是getline函数和get函数不同之处。 



ignore函数

使用该函数可以跳过输入流中的n个字符或者遇到指定的字符提前结束（跳过终止字符在内的若干字符）

如ignore(5, 'A')

跳过输入流中的5个字符，遇到字符A就不在往后跳了

也可以省略掉参数

ignore()

默认是跳过1个字符，终止字符默认是EOF，相当于ignore（1， EOF）

**对于get函数以及ignore函数对于每一个流对象都可以调用**



流：就是数据在进行传输

输入输出流就是指由若干字节组成的字节序列，这些字节中的数据按顺序从一个对象传送到另一个对象

cout输出流：cout << "5" ,将5按顺序**插入**到输出流，然后输出流自己进行输出，然后输出流自己在输出到标准输出设备上（显示屏）

cin输入流：cin >> ch，从输入流中**提取**数据放到ch中，输入流是和标准输入进行相关联，从标准输入输入数据放到输入流中（键盘）



**输入和输出并不是C++语言的正式组成成分，而是在编译系统提供的I/O库中定义的**



**在定义；流对象的时候，系统会在内存中开辟一端缓存区，用来暂存输入输出流的数据**

对于**输出流和输入流自己内部都有一个缓存区**，将数据都放到这个缓存区中。

对于输出流来说：这个缓存区是行缓存区，当缓存区满了或者遇到了换行符就会将缓存区中的数据全部都输出到标准输出设备上（显示屏）

对于输入流来说：从键盘输入数据放到输入流cin中，然后从cin流中提取数据给与指定的变量

插图：流进行输入和输出

![](C:\Users\0\Pictures\C++\io流.png)

有关流对象和流运算符的定义等信息是存放在C++的输入输出库中的。如果在程序中使用cin，cout流对象和流运算符就必须包含头文件。

